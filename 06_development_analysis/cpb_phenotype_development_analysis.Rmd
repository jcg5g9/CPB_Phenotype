---
ttitle: "Analysis 6: Development analysis"
author: "Joe Gunn"
date: "2024-09-19"
output: html_document
---

# <b>Project:</b> Assessing phenotypic response and transgenerational inheritance following insecticide exposure in Colorado Potato Beetles (<i>Leptinotarsa decemlineata</i>; CPB) 
<font size="+1"> We assessed inter- and trans-generational effects of sublethal insecticide exposure on four larval performance phenotypes (fecundity, herbivory, mobility, and development) in Colorado potato beetles (<i>Leptinotarsa decemlineata</i>; CPB). We implemented a replicated inbred full-sibling pedigree design, beginning with 12 "founder" mated pair lineages and continuing for four successive generations (full siblings within lineages were inbred in each generation). For the transgenerational experiment, F<sub>0</sub> larvae (offspring of founder pairs) were divided into two treatment groups (exposed, i.e., exposed to a sub-lethal [10-ppm] dose of the neonicotinoid insecticide imidacloprid; and control, i.e., exposed to an equivalent dose of molecular-grade water). A subset of beetles were collected from each treatment within each lineage for each generation and monitored for four performance traits, including larval movement (mobility), feeding rate (herbivory), and time to discrete life stages (development). Performance traits were monitored in three successive generations (F<sub>1</sub>-F<sub>3</sub>) without treatment exposure and compared to the F<sub>0</sub> generation to test for inter- and transgenerationally-inherited phenotypic variation. An additional subset of larvae from each generation were re-exposed to treatments, both experimental (insecticide-exposed) and control (water), to test for potential selection of phenotypic variation across generations.</font>

# <b>Specific Aim:</b> Development analysis
<font size="+1">In this analysis, we assess differences in larval development (i.e., time to pupation, time from pupae to adult emergence, pupal mass, and adult mass) among mated pairs in the transgenerational experiment by generation (i.e., F0, F1, F2, F3), lineage (i.e., L1, L2, ... L10), and treatment (i.e., control and exposed). </font>

## Phases of Analysis
### Phase 1: Data Summary Statistics
### Phase 2: 

### Libraries needed for analysis
```{r}
library(tidyverse)
library(cowplot)
library(readxl)
library(writexl)
```

## PHASE 1: DATA SUMMARY STATISTICS
In this phase of the analysis, we calculate raw values for larval development metrics (i.e., time to pupal stage and duration of pupation) and calculate mean, standard deviation, and variance for all metrics (including also pupal mass and adult mass) within experimental groups of interest.

### STEP 1: Calculate raw values and summary statistics for development data
In this step, we calculate mean, standard deviation, and variance for herbivory (i.e., total leaf area consumed) for all experimental groups.

#### 1a. Calculate raw values for time to pupation and pupal duration metrics; run the Rmd chunk below
In this step, we calculate time to pupation as the number of days between the date of the assay for an individual larva (instar-3) and the date of complete pupa formation. We calculate duration of pupation as the time between the date of full pupa formation and the date of full adult eclosure (i.e., emergence).

##### Calculate raw values for time to pupation and pual duration:
```{r}
# load pupa time data
load("data/pupa_time.Rda")

# calculate time to pupation ("pupa_time")
pupa_time <- pupa_time %>%
  mutate(pupa_time = as.integer(difftime(pupa_date, assay_date, "days")))

# load pupa duration data
load("data/pupa_duration.Rda")

# calculate duration of pupation ("pupa_duration")
pupa_duration <- pupa_duration %>%
  mutate(pupa_duration = as.integer(difftime(emerge_date, pupa_date, "days")))

```


#### 1b. Calculate summary statistics for all larval development data; run the Rmd chunk below.

##### Calculate summary statistics for larval development data:
```{r}
# load herbivory data
load("data/.Rda")

# get sample size (n), mean, standard deviation (sd), and standard error (se) for walking rate by generation and treatment
herbivory %>%
  group_by(larval_generation, background, treatment) %>% 
  summarize(n = n(),
            mean = mean(total_leaf_area),
            sd = sd(total_leaf_area),
            se = sd/sqrt(n()))
```
