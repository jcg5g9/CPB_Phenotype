---
title: "extra"
output: html_document
---

### STEP 2: Assess phenotypic memory and response in average walking speed.
In this step, we assess phenotypic memory and response in average walking speed by larvae.

#### 2a: Test fit of empirical data to a normal distribution; run the Rmd chunk below.
In this step, we use the shapiro-wilk test to assess whether average walking speed among larvae in each group of interest deviates from a normal distribution.

##### Test fit of normality:
```{r}
# load mobility data
load("data/mobility.Rda")

# set to show decimals rather than scientific notation for p-value assessments
options(scipen = 999)

# test for fit of normality with treatments and generations and compare to alpha of 0.05/14 = 0.003 (to account for multiple comparisons)
mobility %>%
  group_by(larval_generation, background, treatment) %>%
  shapiro_test(ave_speed) %>%
  mutate(alpha = 0.003) %>%
  mutate(deviates = ifelse(p < alpha, "yes", "no"))
```

<b>Analysis results:</b> <br>

<b>Shapiro-wilk p-values for each treatment and generation:</b><br>
<b>F0_C_C: p < 0.001 </b><br>
<b>F0_C_E: p < 0.001 </b><br>
<b>F1_C_C: p < 0.001 </b><br>
<b>F1_C_E: p = 0.010 </b><br>
<b>F1_E_C: p = 0.002 </b><br>
<b>F1_E_E: p < 0.001 </b><br>
<b>F2_C_C: p = 0.180 </b><br>
<b>F2_C_E: p = 0.010 </b><br>
<b>F2_E_C: p = 0.082 </b><br>
<b>F2_E_E: p = 0.199 </b><br>
<b>F3_C_C: p < 0.001 </b><br>
<b>F3_C_E: p = 0.012 </b><br>
<b>F3_E_C: p = 0.011 </b><br>
<b>F3_E_E: p < 0.001 </b><br>

Since 7/14 tests for normality fit indicate a deviation from a normal distribution, we apply a square-root transformation to the raw data to prepare for analysis.

#### 2b: Square-root transform average walking speed data and re-assess fit of normal distribution; run the Rmd chunk below.
In this step, we calculate the square root of the raw average speed data and re-assess the fit of the transformed data to a normal distribution.

##### Transform data and re-assess fit of normality:
```{r}
# load mobility data
load("data/mobility.Rda")

# set to show decimals rather than scientific notation for p-value assessments
options(scipen = 999)

# square root transform walking speed data and add to dataset
speed <- mobility %>%
  mutate(sqrt_speed = sqrt(ave_speed))

# re-assess fit of normality to square-root-transformed data (based on p-value correction for multiple tests)
speed %>%
  group_by(larval_generation, background, treatment) %>%
  shapiro_test(sqrt_speed) %>%
  mutate(alpha = 0.003) %>%
  mutate(deviates = ifelse(p < alpha, "yes", "no"))

# save transformed speed mobility data
save(speed, file = "data/speed.Rda")
```

<b>Analysis results:</b> <br>

<b>Shapiro-wilk p-values for each treatment and generation:</b><br>
<b>F0_C_C: p = 0.436 </b><br>
<b>F0_C_E: p = 0.008 </b><br>
<b>F1_C_C: p = 0.289 </b><br>
<b>F1_C_E: p = 0.394 </b><br>
<b>F1_E_C: p = 0.354 </b><br>
<b>F1_E_E: p = 0.103 </b><br>
<b>F2_C_C: p = 0.423 </b><br>
<b>F2_C_E: p = 0.343 </b><br>
<b>F2_E_C: p = 0.577 </b><br>
<b>F2_E_E: p = 0.094 </b><br>
<b>F3_C_C: p = 0.100 </b><br>
<b>F3_C_E: p = 0.548 </b><br>
<b>F3_E_C: p = 0.169 </b><br>
<b>F3_E_E: p = 0.159 </b><br>

All 14 tests indicate fit of the normal distribution, so we continue with analysis using these transformed data.

#### 2c: Assess phenotypic memory of insecticide stress in average walking speed; run the Rmd chunk below.

##### Assess phenotypic memory of insecticide stress in average walking speed:
```{r}

```

#### 2d: Plot transformed data for average walking speed to visualize phenotypic memory; run the Rmd chunk below.

##### Plot transformed data for phenotypic memory analysis: `figures/speed_memory.jpeg`
```{r}
# load speed mobility data
load("data/speed.Rda")

# get only individuals given the control in each generation (for both background exposure groups)
speed <- speed %>%
  filter(treatment == "C")

# calculate means, standard deviation, and standard error of square-root transformed data 
speed <- speed %>%
  group_by(larval_generation, background) %>%
  summarize(mean = mean(sqrt_speed),
            sd = sd(sqrt_speed),
            n = n(),
            se = sd/sqrt(n))

# plot transformed data by background, generation, and treatment
jpeg("figures/speed_memory.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(speed, aes(x = larval_generation, y = mean, fill = background)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 0.8, by = 0.2)) +
  ylim(0,0.8) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of walking speed (mm/s)", fill = "Background") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```

#### 2e: Assess phenotypic response to insecticide stress in average walking speed; run the Rmd chunk below.

##### Assess phenotypic response to insecticide stress in average walking speed:
```{r}

```

#### 2f: Plot transformed data for average walking speed to visualize phenotypic response; run the Rmd chunk below.

##### Plot transformed data for phenotypic response analysis (for both control and exposed background samples): 1. `figures/speed_response_control.jpeg`; 2.`figures/speed_response_exposed.jpeg`
```{r}
# load speed mobility data
load("data/speed.Rda")

# calculate means, standard deviation, and standard error of square-root transformed data 
speed <- speed %>%
  group_by(larval_generation, background, treatment) %>%
  summarize(mean = mean(sqrt_speed),
            sd = sd(sqrt_speed),
            n = n(),
            se = sd/sqrt(n))

# Convert background to "C" for both F0 groups and change treatment to C and E for each group, respectively
speed_c <- speed
speed_c$background[2] <- "C" 
speed_c$treatment[2] <- "E"

# get only individuals with the control background
speed_c <- speed_c %>%
  filter(background == "C")

# Convert background to "E" for both F0 groups and change treatment to C and E for each group, respectively
speed_e <- speed
speed_e$background[1] <- "E" 
speed_e$treatment[2] <- "E"

# get only individuals with the exposed background
speed_e <- speed_e %>%
  filter(background == "E")

# plot transformed data by background, generation, and treatment for control background
jpeg("figures/speed_response_control.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(speed_c, aes(x = larval_generation, y = mean, fill = treatment)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 0.8, by = 0.2)) +
  ylim(0,0.8) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of walking speed (mm/s)", fill = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()

# plot transformed data by background, generation, and treatment for exposed background
jpeg("figures/speed_response_exposed.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(speed_e, aes(x = larval_generation, y = mean, fill = treatment)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 0.8, by = 0.2)) +
  ylim(0,0.8) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of walking speed (mm)", fill = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```

### STEP 3: Assess phenotypic memory and response in average walking acceleration.
In this step, we assess phenotypic memory and response in average walking acceleration by larvae.

#### 3a: Test fit of empirical data to a normal distribution; run the Rmd chunk below.
In this step, we use the shapiro-wilk test to assess whether average walking acceleration among larvae in each group of interest deviates from a normal distribution.

##### Test fit of normality:
```{r}
# load mobility data
load("data/mobility.Rda")

# set to show decimals rather than scientific notation for p-value assessments
options(scipen = 999)

# test for fit of normality with treatments and generations and compare to alpha of 0.05/14 = 0.003 (to account for multiple comparisons)
mobility %>%
  group_by(larval_generation, background, treatment) %>%
  shapiro_test(ave_accel) %>%
  mutate(alpha = 0.003) %>%
  mutate(deviates = ifelse(p < alpha, "yes", "no"))
```

<b>Analysis results:</b> <br>

<b>Shapiro-wilk p-values for each treatment and generation:</b><br>
<b>F0_C_C: p < 0.001 </b><br>
<b>F0_C_E: p < 0.001 </b><br>
<b>F1_C_C: p = 0.072 </b><br>
<b>F1_C_E: p < 0.001 </b><br>
<b>F1_E_C: p < 0.001 </b><br>
<b>F1_E_E: p < 0.001 </b><br>
<b>F2_C_C: p = 0.091 </b><br>
<b>F2_C_E: p = 0.107 </b><br>
<b>F2_E_C: p = 0.055 </b><br>
<b>F2_E_E: p = 0.891 </b><br>
<b>F3_C_C: p < 0.001 </b><br>
<b>F3_C_E: p = 0.008 </b><br>
<b>F3_E_C: p = 0.002 </b><br>
<b>F3_E_E: p = 0.001 </b><br>

Since 8/14 tests for normality fit indicate a deviation from a normal distribution, we apply a square-root transformation to the raw data to prepare for analysis.

#### 3b: Square-root transform average walking acceleration data and re-assess fit of normal distribution; run the Rmd chunk below.
In this step, we calculate the square root of the raw average acceleration data and re-assess the fit of the transformed data to a normal distribution.

##### Transform data and re-assess fit of normality:
```{r}
# load mobility data
load("data/mobility.Rda")

# set to show decimals rather than scientific notation for p-value assessments
options(scipen = 999)

# square root transform walking acceleration data and add to dataset
acceleration <- mobility %>%
  mutate(sqrt_accel = sqrt(ave_accel))

# re-assess fit of normality to square-root-transformed data (based on p-value correction for multiple tests)
acceleration %>%
  group_by(larval_generation, background, treatment) %>%
  shapiro_test(sqrt_accel) %>%
  mutate(alpha = 0.003) %>%
  mutate(deviates = ifelse(p < alpha, "yes", "no"))

# save transformed acceleration mobility data
save(acceleration, file = "data/acceleration.Rda")
```

<b>Analysis results:</b> <br>

<b>Shapiro-wilk p-values for each treatment and generation:</b><br>
<b>F0_C_C: p = 0.011 </b><br>
<b>F0_C_E: p = 0.007 </b><br>
<b>F1_C_C: p = 0.652 </b><br>
<b>F1_C_E: p = 0.595 </b><br>
<b>F1_E_C: p = 0.129 </b><br>
<b>F1_E_E: p = 0.004 </b><br>
<b>F2_C_C: p = 0.609 </b><br>
<b>F2_C_E: p = 0.157 </b><br>
<b>F2_E_C: p = 0.368 </b><br>
<b>F2_E_E: p = 0.353 </b><br>
<b>F3_C_C: p = 0.004 </b><br>
<b>F3_C_E: p = 0.296 </b><br>
<b>F3_E_C: p = 0.076 </b><br>
<b>F3_E_E: p = 0.145 </b><br>

All 14 tests indicate fit of the normal distribution, so we continue with analysis using these transformed data.

#### 3c: Assess phenotypic memory of insecticide stress in average acceleration; run the Rmd chunk below.

##### Assess phenotypic memory of insecticide stress in average acceleration:
```{r}

```

#### 3d: Plot transformed data for average acceleration to visualize phenotypic memory; run the Rmd chunk below.

##### Plot transformed data for phenotypic memory analysis: `figures/speed_memory.jpeg`
```{r}
# load speed mobility data
load("data/acceleration.Rda")

# get only individuals given the control in each generation (for both background exposure groups)
acceleration <- acceleration %>%
  filter(treatment == "C")

# calculate means, standard deviation, and standard error of square-root transformed data 
acceleration <- acceleration %>%
  group_by(larval_generation, background) %>%
  summarize(mean = mean(sqrt_accel),
            sd = sd(sqrt_accel),
            n = n(),
            se = sd/sqrt(n))

# plot transformed data by background, generation, and treatment
jpeg("figures/acceleration_memory.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(acceleration, aes(x = larval_generation, y = mean, fill = background)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 1.5, by = 0.5)) +
  ylim(0,1.5) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of acceleration (mm/s/s)", fill = "Background") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```

#### 3e: Assess phenotypic response to insecticide stress in average acceleration; run the Rmd chunk below.

##### Assess phenotypic response to insecticide stress in average acceleration:
```{r}

```

#### 3f: Plot transformed data for average acceleration to visualize phenotypic response; run the Rmd chunk below.

##### Plot transformed data for phenotypic response analysis (for both control and exposed background samples): 1. `figures/acceleration_response_control.jpeg`; 2.`figures/acceleration_response_exposed.jpeg`
```{r}
# load acceleration mobility data
load("data/acceleration.Rda")

# calculate means, standard deviation, and standard error of square-root transformed data 
acceleration <- acceleration %>%
  group_by(larval_generation, background, treatment) %>%
  summarize(mean = mean(sqrt_accel),
            sd = sd(sqrt_accel),
            n = n(),
            se = sd/sqrt(n))

# Convert background to "C" for both F0 groups and change treatment to C and E for each group, respectively
acceleration_c <- acceleration
acceleration_c$background[2] <- "C" 
acceleration_c$treatment[2] <- "E"

# get only individuals with the control background
acceleration_c <- acceleration_c %>%
  filter(background == "C")

# Convert background to "E" for both F0 groups and change treatment to C and E for each group, respectively
acceleration_e <- acceleration
acceleration_e$background[1] <- "E" 
acceleration_e$treatment[2] <- "E"

# get only individuals with the exposed background
acceleration_e <- acceleration_e %>%
  filter(background == "E")

# plot transformed data by background, generation, and treatment for control background
jpeg("figures/acceleration_response_control.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(acceleration_c, aes(x = larval_generation, y = mean, fill = treatment)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 1.5, by = 0.5)) +
  ylim(0,1.5) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of acceleration (mm/s/s)", fill = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()

# plot transformed data by background, generation, and treatment for exposed background
jpeg("figures/acceleration_response_exposed.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(acceleration_e, aes(x = larval_generation, y = mean, fill = treatment)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 1.5, by = 0.5)) +
  ylim(0,1.5) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of acceleration (mm/s/s)", fill = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```


### Distance memory boxplot:
```{r}
jpeg("figures/distance_memory.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(distance, aes(x = larval_generation, y = mean, fill = background)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of distance (mm)", fill = "Background") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```

```{r}
# plot transformed data by background, generation, and treatment for control background
jpeg("figures/distance_response_control.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(distance_c, aes(x = larval_generation, y = mean, fill = treatment)) + 
  geom_bar(position = position_dodge(), stat = "identity", show.legend = T, color = "black", linewidth = 1.5) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.4, position = position_dodge(0.9), linewidth = 1.5) + 
  theme_set(theme_cowplot(12)) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.75)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(1, 'cm')) +
  theme(legend.key.spacing.y = unit(0.2, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(10, 10, 10, 10)) +
  labs(x = "Larval generation", y = "Square root of distance (mm)", fill = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(15,15,15,15))

dev.off()
```

### STEP 1: Simulate data to visualize hypotheses for assessing phenotypic memory and phenotypic response following insecticide exposure.
In this step, we generate figures representing null and alternative hypotheses for assessing phenotypic memory vs. phenotypic response following exposure to the insecticide and control treatments in the transgenerational experiment. We generate simulated data and graphically visualize expected patterns of phenotypic variation between treatments and across generations.

#### 1a: Simulate data and visualize null (H<sub>n</sub>) and alternative (H<sub>a</sub>) hypotheses for phenotypic memory analysis.
Here, we generate data tables to simulate expected patterns in phenotpyic memory assuming the null hypothesis (i.e., that any phenotypic difference between control and insecticide-exposed individuals in the F0 generation will not be maintained over successive generations) and alternative hypothesis (i.e., that any phenotypic difference between control and insecticide-treated F0 individuals will be maintained accross generations).

##### 1a.1. Simulate and visualize data for H<sub>n</sub>; run the Rmd chunk below.

##### Simulate data and generate figure for H<sub>n</sub>: `figures/hn_memory.jpeg`
```{r}
# generate test data for null hypothesis
hn_memory <- tibble(
  larval_generation = c(rep("F0", times = 2),
                        rep("F1", times = 2), 
                        rep("F2", times = 2), 
                        rep("F3", times = 2)),
  background = c(rep(c("C","E"), times = 4)),
  treatment = c(rep("C", times = 8)),
  mean = as.numeric(c(rep("10", times = 1),
           rep("5", times = 1),
           rep("10", times = 6))),
  se = as.numeric(c(rep("0.8", times = 8)))
  )

# plot hypothesis data by background, generation, and treatment
jpeg("figures/hn_memory.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(hn_memory, aes(x = larval_generation, y = mean, group = background)) + 
  geom_line(aes(color = background), linewidth = 2) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se, color = background), position = position_dodge(width = 0.1), width = 0.2, linewidth = 2) +
  geom_point(aes(x = larval_generation, y = mean, group = background, fill = background), position = position_dodge(width = 0.1), size = 5, pch = 22, stroke = 2, color = "black") +
  theme_set(theme_cowplot(12)) +
  scale_color_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.5)) +
  theme(axis.text.x = element_text(hjust = 0.5)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(2, 'cm')) +
  theme(legend.key.spacing.y = unit(-0.5, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(5, 10, 1, 10)) +
  labs(x = "Larval generation", y = expression(sqrt("distance (mm)")), fill = "Background", color = "Background") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(20,20,20,20))

dev.off()
```

##### 1a.2. Simulate and visualize data for H<sub>a</sub>; run the Rmd chunk below.

##### Simulate data and generate figure for H<sub>a</sub>: `figures/ha_memory.jpeg`
```{r}
# generate test dataset for alternative hypothesis
ha_memory <- tibble(
  larval_generation = c(rep("F0", times = 2),
                        rep("F1", times = 2), 
                        rep("F2", times = 2), 
                        rep("F3", times = 2)),
  background = c(rep(c("C","E"), times = 4)),
  treatment = c(rep("C", times = 8)),
  mean = as.numeric(c(rep(c("10","5"), times = 4))),
  se = as.numeric(c(rep("0.8", times = 8)))
  )

# plot hypothesis data by background, generation, and treatment
jpeg("figures/ha_memory.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(ha_memory, aes(x = larval_generation, y = mean, group = background)) + 
  geom_line(aes(color = background), linewidth = 2) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se, color = background), position = position_dodge(width = 0.1), width = 0.2, linewidth = 2) +
  geom_point(aes(x = larval_generation, y = mean, group = background, fill = background), position = position_dodge(width = 0.1), size = 5, pch = 22, stroke = 2, color = "black") +
  theme_set(theme_cowplot(12)) +
  scale_color_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.5)) +
  theme(axis.text.x = element_text(hjust = 0.5)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(2, 'cm')) +
  theme(legend.key.spacing.y = unit(-0.5, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(5, 10, 1, 10)) +
  labs(x = "Larval generation", y = expression(sqrt("distance (mm)")), fill = "Background", color = "Background") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(20,20,20,20))

dev.off()
```

#### 1b: Simulate data and visualize null (H<sub>n</sub>) and alternative (H<sub>a</sub>) hypotheses for phenotypic response analysis.
Here, we generate data tables to simulate expected patterns in phenotpyic response assuming the null hypothesis (i.e., that any phenotypic difference between control and insecticide-treated individuals with a background of insecticide exposure in the F0 generation will be maintained over successive generations) and alternative hypothesis (i.e., that any phenotypic difference between control and insecticide-treated exposed F0 individuals will vary across generations).

##### 1b.1. Simulate and visualize data for H<sub>n</sub>; run the Rmd chunk below.

##### Simulate data and generate figure for H<sub>n</sub>: `figures/hn_response.jpeg`
```{r}
# generate test data for null hypothesis
hn_response <- tibble(
  larval_generation = c(rep("F0", times = 2),
                        rep("F1", times = 2), 
                        rep("F2", times = 2), 
                        rep("F3", times = 2)),
  background = c(rep("E", times = 8)),
  treatment = c(rep(c("C","E"), times = 4)),
  mean = as.numeric(c(rep(c("10","5"), times = 4))),
  se = as.numeric(c(rep("0.8", times = 8)))
  )

# plot hypothesis data by background, generation, and treatment
jpeg("figures/hn_response.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(hn_response, aes(x = larval_generation, y = mean, group = treatment)) + 
  geom_line(aes(color = treatment), linewidth = 2) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se, color = treatment), position = position_dodge(width = 0.1), width = 0.2, linewidth = 2) +
  geom_point(aes(x = larval_generation, y = mean, group = treatment, fill = treatment), position = position_dodge(width = 0.1), size = 5, pch = 22, stroke = 2, color = "black") +
  theme_set(theme_cowplot(12)) +
  scale_color_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.5)) +
  theme(axis.text.x = element_text(hjust = 0.5)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(2, 'cm')) +
  theme(legend.key.spacing.y = unit(-0.5, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(5, 10, 1, 10)) +
  labs(x = "Larval generation", y = expression(sqrt("distance (mm)")), fill = "Treatment", color = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(20,20,20,20))

dev.off()
```

##### 1b.2. Simulate and visualize data for H<sub>a</sub>; run the Rmd chunk below.

##### Simulate data and generate figure for H<sub>a</sub>: `figures/ha_response.jpeg`
```{r}
# generate test dataset for alternative hypothesis
ha_response <- tibble(
  larval_generation = c(rep("F0", times = 2),
                        rep("F1", times = 2), 
                        rep("F2", times = 2), 
                        rep("F3", times = 2)),
  background = c(rep("E", times = 8)),
  treatment = c(rep(c("C","E"), times = 4)),
  mean = as.numeric(c(rep("10", times = 1),
           rep("5", times = 1),
           rep(c("10","14"), times = 3))),
  se = as.numeric(c(rep("0.8", times = 8)))
  )

# plot hypothesis data by background, generation, and treatment
jpeg("figures/ha_response.jpeg", width = 10000, height = 8000, res = 700)
 
ggplot(ha_response, aes(x = larval_generation, y = mean, group = treatment)) + 
  geom_line(aes(color = treatment), linewidth = 2) + 
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se, color = treatment), position = position_dodge(width = 0.1), width = 0.2, linewidth = 2) +
  geom_point(aes(x = larval_generation, y = mean, group = treatment, fill = treatment), position = position_dodge(width = 0.1), size = 5, pch = 22, stroke = 2, color = "black") +
  theme_set(theme_cowplot(12)) +
  scale_color_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_fill_manual(values = c("deepskyblue2", "firebrick3")) +
  scale_y_continuous(breaks = seq(from = 0, to = 15, by = 3)) +
  ylim(0,15) +
  theme(axis.text.x = element_text(angle = 0, hjust = 1)) + 
  theme(axis.text = element_text(size = 30, hjust = 0.4)) + 
  theme(axis.title = element_text(size = 40, hjust = 0.5)) + 
  theme(axis.title.y = element_text(vjust = +3)) + 
  theme(axis.title.x = element_text(vjust = -0.5)) +
  theme(axis.text.x = element_text(hjust = 0.5)) +
  theme(legend.position = c(0.05,0.87)) + 
  theme(legend.text = element_text(size = 30)) +
  theme(legend.title = element_text(size = 30, face = "bold")) +
  theme(legend.key.size = unit(2, 'cm')) +
  theme(legend.key.spacing.y = unit(-0.5, 'cm')) +
  theme(legend.box.background = element_rect(color = "black", size = 1.5)) +
  theme(legend.box.margin = margin(5, 10, 1, 10)) +
  labs(x = "Larval generation", y = expression(sqrt("distance (mm)")), fill = "Treatment", color = "Treatment") +
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 2)) +
  theme(plot.margin = margin(20,20,20,20))

dev.off()